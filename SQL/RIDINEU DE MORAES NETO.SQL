-- 1

SELECT NRAMBUL
FROM AMBULATORIOS
WHERE CAPACIDADE = (SELECT MAX(CAPACIDADE) FROM AMBULATORIOS); 

-- 2

SELECT NMMEDICO, COUNT(RGPACIENTE)
FROM MEDICOS, CONSULTAS
WHERE MEDICOS.CRM = CONSULTAS.CRM
Group by NMMEDICO;

-- 3

UPDATE CONSULTAS SET DATACONSULTA = DATACONSULTA + 10
WHERE RGPACIENTE = (SELECT RGPACIENTE 
					FROM PACIENTES 
					WHERE DOENCA = 'alergia');

-- 4    -erro
 
CREATE OR REPLACE VIEW questaoQuatro
AS 
  SELECT NMMEDICO
  FROM MEDICOS
  WHERE CRM IN (SELECT CRM
				FROM CONSULTAS
				WHERE DATACONSULTA BETWEEN '01/01/2005' AND '31/12/2015' 
				GROUP BY CRM
				HAVING COUNT(CRM) > 1);

-- 5

SELECT RGPACIENTE, NMPACIENTE, IDADE 
FROM PACIENTES
		MINUS
SELECT P.RGPACIENTE, NMPACIENTE, P.IDADE 
FROM PACIENTES P, MEDICOS M, CONSULTAS C
WHERE P.RGPACIENTE = C.RGPACIENTE AND 
      C.CRM = M.CRM AND 
      ESPECIALIDADE = 'Cardiologista';

-- 6

SELECT A.NRAMBUL, NRANDAR, NMPACIENTE
FROM AMBULATORIOS A, CONSULTAS C, MEDICOS M, PACIENTES P
WHERE A.NRAMBUL = M.NRAMBUL AND M.CRM = C.CRM AND
      C.RGPACIENTE = P.RGPACIENTE AND 
      M.CRM IN (SELECT CRM
            FROM MEDICOS
            WHERE NMMEDICO = 'João Carlos Santos' 
				  OR  NMMEDICO = 'Maria Souza');

-- 7

SELECT NMMEDICO, DATACONSULTA
FROM MEDICOS M, CONSULTAS C
WHERE M.CRM = C.CRM AND
      VRCONSULTA > (SELECT AVG(VRCONSULTA)
                    FROM CONSULTAS);

-- 8

UPDATE AMBULATORIOS SET NRANDAR = (SELECT NRANDAR 
                                   FROM AMBULATORIOS A, MEDICOS M
                                   WHERE A.NRAMBUL = M.NRAMBUL AND
                                   NMMEDICO = 'Luciano')
WHERE NRAMBUL = (SELECT NRANDAR 
                 FROM AMBULATORIOS A, MEDICOS M
                 WHERE A.NRAMBUL = M.NRAMBUL AND
                 NMMEDICO = 'João Carlos Santos');   
